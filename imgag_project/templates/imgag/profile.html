{% extends 'imgag/base.html' %}
{% load staticfiles %}
{% block title %}
	{{ user.username }} Profile
{% endblock %}
	
{% block body_block %}
	<div class="page-header">
		<h1>{{ user.username }} Profile</h1>
	</div>
	<div id="dropzone" style="background-color:powderblue;">
	<form  style="background-color:powderblue;" action="{% url 'upload' %}" class="dropzone needsclick" id="demoUpload" method="post" enctype="multipart/form-data">
	{% csrf_token %}
		<input type="text" placeholder="Write header..." name="header" id="header"> <br />
		<div class="dz-message needsclick">
			Drop files here or click to upload.<br />
		</div>
	</form>
	</div>
	<button type="submit" id="submitFile" >UPLOAD</button>
	<p id="note"></p>
    {% if userprofile.picture %}
    <img src="{{ MEDIA_URL }}{{userprofile.picture }}" width="300" height="300" alt="{{user.username}}" />
    {% else %}
    <img src="http://lorempixel.com/300/300/" img width="300" height="300" alt="{{user.username}}"/>
    {% endif %}
	<br/><br/>
	<div id="profile_data">
		{% if selecteduser.username == user.username %}
    	<form method="post" action="." enctype="multipart/form-data">
    		{% csrf_token %}
    		{{ form.as_p }}
    		<input type="submit" value="Update" />
    	</form>
        {% else %}
		<p><strong>Email:</strong> {{selecteduser.email}}</p>
		<p><strong>Website:</strong> <a href="{{userprofile.website}}">{{userprofile.website}}</a></p>
		{% endif %}
	</div>
	<link rel="stylesheet" href="https://rawgit.com/enyo/dropzone/master/dist/dropzone.css">
	<script src="{% static 'js/dropzone.js' %}"></script>
	<script type="text/javascript">
		var formStyle = document.querySelector("#demoUpload").style;
		formStyle.backgroundColor = "gray";
		formStyle.borderStyle = "dashed groove";
		Dropzone.options.demoUpload = {
			maxFilesize: 15,
			paramName: "file",
			clickable: true,
			autoProcessQueue: false,
			maxFiles: 1,
			
			init : function(){
				var dropThis = this;
				var submitting = document.querySelector("#submitFile");
				submitting.addEventListener("click", function() {
					var content = document.querySelector("#header").value;
					if(!content.length){
						document.querySelector("#note").innerHTML = "<strong>Each post must have a header!</strong>";
					} else {
						dropThis.processQueue();
					}
					
					});
				this.on("maxfilesexceeded", function(file){
					document.querySelector("#note").innerHTML = "You can only upload one file at a time!";
					this.removeFile(file);
				});
			}
		}
		
	</script>
	
{% endblock %}
